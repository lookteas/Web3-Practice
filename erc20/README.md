# ERC20 代币项目

本目录中的内容为 基于ERC20标准 实现相关的测试项目，包含基础代币实现、扩展功能和模拟银行合约和银行升级版合约（v2），仅用于测试和学习 ERC20。

## 项目结构

```
erc20/
├── BaseERC20.sol     - ERC20 基础合约实现
├── ExpendERC20.sol   - ERC20 扩展功能合约
├── ITokenReceiver.sol - 代币接收者接口
├── MyToken.sol       - 自定义代币合约
├── TokenBank.sol     - 银行合约
└── TokenBankV2.sol   - 银行升级版合约
```

## 合约说明

### BaseERC20.sol

基础 ERC20 代币合约，实现了 ERC20 标准的所有核心功能：

- 代币基本信息（名称、符号、小数位数）
- 代币总供应量管理
- 账户余额查询
- 代币转账功能
- 授权和委托转账
- 标准 ERC20 事件

### ExpendERC20.sol

ERC20 扩展功能合约，增加了高级特性：

- 安全转账（SafeTransfer）
- 智能合约代币接收回调
- 批量转账优化
- Gas 费用优化
- 额外的安全检查

### ITokenReceiver.sol

代币接收者接口合约：

- 定义了智能合约接收代币的标准接口
- 支持代币接收回调功能
- 允许合约对接收到的代币做出响应

### MyToken.sol

自定义 ERC20 代币合约，继承自 BaseERC20：

- 可铸造（Mintable）
- 可销毁（Burnable）
- 权限控制
- DeFi 生态系统集成支持

### TokenBank.sol

银行合约，提供代币存储和管理功能：

- 代币存款
- 代币提现
- 利息计算
- 余额查询
- 安全保障机制

### TokenBankV2.sol

银行升级版合约，增加了新特性：

- 改进的利息模型
- 更多的安全措施
- 紧急提现功能
- 管理员控制功能
- 事件日志优化

## 主要功能

1. **代币基础功能**
   - 转账和授权
   - 余额管理
   - 铸造和销毁

2. **扩展功能**
   - 安全转账
   - 批量操作
   - 智能合约交互

3. **银行功能**
   - 存款和提现
   - 利息管理
   - 安全控制

## 安全特性

1. **代码安全**
   - 重入攻击防护
   - 溢出检查
   - 权限控制

2. **转账安全**
   - 地址验证
   - 余额检查
   - 合约交互验证

3. **银行安全**
   - 存款限额
   - 提现控制
   - 紧急暂停

## 使用示例

### 1. 部署基础代币
```solidity
// 部署 MyToken
MyToken token = new MyToken("MyToken", "MTK");
```

### 2. 使用扩展功能
```solidity
// 安全转账
ExpendERC20 token = ExpendERC20(tokenAddress);
token.safeTransfer(recipient, amount);
```

### 3. 使用代币银行
```solidity
// 存款
TokenBank bank = TokenBank(bankAddress);
token.approve(bankAddress, amount);
bank.deposit(amount);
```

## 部署流程

1. 部署基础代币合约
2. 部署扩展功能合约（如需要）
3. 部署银行合约
4. 设置必要的权限和参数
5. 进行功能测试

## 测试建议

1. **单元测试**
   - 基本功能测试
   - 边界条件测试
   - 权限测试

2. **集成测试**
   - 合约间交互测试
   - 回调功能测试
   - 银行功能测试

3. **安全测试**
   - 重入攻击测试
   - 权限控制测试
   - 异常情况处理测试

## 部署检查清单

- [ ] 合约参数配置正确
- [ ] 所有测试通过
- [ ] 代码审计完成
- [ ] Gas 优化检查
- [ ] 权限设置正确
- [ ] 紧急处理机制就绪

## 最佳实践

1. 始终使用安全转账函数
2. 实现紧急暂停机制
3. 限制单次操作金额
4. 保持合约简单性
5. 记录详细的事件日志

## 升级说明

从 TokenBank 升级到 TokenBankV2：
1. 部署新版本合约
2. 迁移用户数据
3. 更新合约引用
4. 验证新功能

## 贡献指南

1. Fork 项目
2. 创建功能分支
3. 提交更改
4. 发起 Pull Request

## 许可证

MIT License